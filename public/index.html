<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover">
	<title>Share to MagicMirror</title>
	<meta name="description" content="Share YouTube videos to your MagicMirror display">
	<link rel="manifest" href="/manifest.webmanifest">
	<link rel="icon" type="image/png" href="/favicon.png">
	<meta name="theme-color" content="#0b0b0b">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
	<meta name="apple-mobile-web-app-title" content="Share to MagicMirror²">
	<link rel="apple-touch-icon" href="/icon-192.png">
	<link rel="apple-touch-icon" sizes="180x180" href="/icon-192.png">
	<link rel="apple-touch-startup-image" href="/icon-512.png">
	
	<!-- PWA meta tags -->
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="application-name" content="Share to MagicMirror²">
	<meta name="msapplication-TileColor" content="#0b0b0b">
	<meta name="msapplication-TileImage" content="/icon-192.png">
	<link rel="stylesheet" href="/styles.css">
</head>
<body>
	<header class="appbar" role="banner">
		<div class="appbar__left">
			<img class="appbar__logo" src="/icon-64.png" alt="" />
			<div class="appbar__titles">
				<div class="appbar__title">Share to MagicMirror²</div>
				<div class="appbar__subtitle">Cast & control YouTube from your phone</div>
			</div>
		</div>
		<div class="appbar__actions">
			<div class="theme-toggle" role="switch" aria-checked="false" aria-label="Toggle dark/light theme" tabindex="0">
				<div class="theme-toggle-track">
					<div class="theme-toggle-thumb">
						<svg class="theme-icon theme-icon-sun" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<circle cx="12" cy="12" r="5"/>
							<path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/>
						</svg>
						<svg class="theme-icon theme-icon-moon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
						</svg>
					</div>
				</div>
			</div>
		</div>
	</header>

	<div id="chromeBanner" class="chrome-banner" style="display: none;">
		<div class="chrome-banner-content">
			<div class="chrome-banner-icon">
				<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<circle cx="12" cy="12" r="10"/>
					<path d="M12 6v6l4 2"/>
				</svg>
			</div>
			<div class="chrome-banner-text">
				<strong>Share Integration Unavailable</strong>
				<p>To enable sharing from YouTube and other apps, please reinstall this PWA using Chrome browser.</p>
			</div>
			<button id="chromeBannerClose" class="chrome-banner-close" aria-label="Close banner">
				<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
					<line x1="18" y1="6" x2="6" y2="18"/>
					<line x1="6" y1="6" x2="18" y2="18"/>
				</svg>
			</button>
		</div>
	</div>

	<main class="main" role="main">
		<section class="card form-section" aria-labelledby="playback-heading">
			<h2 id="playback-heading" class="sr-only">Video Playback Controls</h2>
			
			<div class="form-row">
				<div class="input-group">
					<label for="url">YouTube URL or Video ID</label>
					<input 
						id="url" 
						type="url" 
						placeholder="https://www.youtube.com/watch?v=..." 
						aria-describedby="url-help"
						autocomplete="url"
					/>
					<div id="url-help" class="sr-only">Enter a YouTube URL or video ID to play on your MagicMirror</div>
				</div>
			</div>

			<div class="button-group">
				<button id="play" class="btn btn--primary" type="button">
					<span class="button-text">Play</span>
				</button>
				<button id="stop" class="btn btn--danger" type="button">
					<span class="button-text">Stop</span>
				</button>
				<button id="install" class="btn" type="button" disabled>
					<span class="button-text">Install App</span>
				</button>
			</div>

			<div class="video-info" id="videoInfo" style="display: none;">
				<h3>Now Playing</h3>
				<div class="video-details">
					<div class="video-thumbnail">
						<img id="videoThumbnail" src="" alt="Video thumbnail" />
						<div class="video-duration" id="videoDuration"></div>
					</div>
					<div class="video-metadata">
						<h4 id="videoTitle">Loading video information...</h4>
						<p id="videoChannel">YouTube</p>
						<div class="video-stats">
							<span id="videoViews"></span>
							<span id="videoPublished"></span>
							<span id="videoLikes"></span>
							<span id="videoCategory"></span>
						</div>
						<div class="video-url" id="videoUrl"></div>
						<div class="video-description" id="videoDescription"></div>
						<div class="video-tags" id="videoTags"></div>
						<div class="video-extra-info">
							<div class="video-quality" id="videoQuality"></div>
							<div class="video-language" id="videoLanguage"></div>
							<div class="video-captions" id="videoCaptions"></div>
						</div>
					</div>
				</div>
				<div class="video-progress" id="videoProgress" style="display: none;">
					<div class="progress-info">
						<span id="currentTime">0:00</span>
						<span id="totalTime">0:00</span>
					</div>
					<div class="progress-bar">
						<div class="progress-fill" id="progressFill"></div>
					</div>
				</div>
			</div>

			<div class="video-controls" id="videoControls" style="display: none;">
				<h3>Video Controls</h3>
				<div class="skip-interval-controls">
					<label for="skipSelect">Skip Interval</label>
					<div class="mm-select" id="skipSelect" data-value="10" aria-describedby="skip-help">
						<button class="mm-select__button" aria-haspopup="listbox" aria-expanded="false" type="button">
							<span id="skipLabel">10 seconds</span>
							<span class="chev">▾</span>
						</button>
						<ul class="mm-select__menu" role="listbox" tabindex="-1" aria-labelledby="skipLabel">
							<li role="option" data-val="5">5 seconds</li>
							<li role="option" data-val="10" aria-selected="true">10 seconds</li>
							<li role="option" data-val="15">15 seconds</li>
							<li role="option" data-val="30">30 seconds</li>
							<li role="option" data-val="60">1 minute</li>
							<li role="option" data-val="120">2 minutes</li>
							<li role="option" data-val="300">5 minutes</li>
						</ul>
					</div>
					<div id="skip-help" class="sr-only">Select the number of seconds to skip when using rewind/forward buttons</div>
				</div>
				<div class="control-buttons">
					<button id="rewind" class="button-control" type="button" title="Rewind">
						<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path d="M11 19l-7-7 7-7"/>
							<path d="M21 12H3"/>
						</svg>
						<span class="button-text" id="rewindText">-10s</span>
					</button>
					<button id="pause" class="button-control" type="button" title="Pause/Resume">
						<svg class="pause-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<rect x="6" y="4" width="4" height="16"/>
							<rect x="14" y="4" width="4" height="16"/>
						</svg>
						<svg class="play-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="display: none;">
							<polygon points="5,3 19,12 5,21"/>
						</svg>
						<span class="button-text">Pause</span>
					</button>
					<button id="forward" class="button-control" type="button" title="Forward">
						<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path d="M3 12h18"/>
							<path d="M13 5l7 7-7 7"/>
						</svg>
						<span class="button-text" id="forwardText">+10s</span>
					</button>
				</div>
				
				<div class="overlay-controls">
					<h4>Mirror Display Mode</h4>
					<div class="control-buttons">
						<button id="mmFSOn" class="button-control" type="button" title="Switch to fullscreen mode">
							<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>
							</svg>
							<span class="button-text">Fullscreen</span>
						</button>
						<button id="mmFSOff" class="button-control" type="button" title="Switch to windowed mode">
							<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
								<path d="M8 3v3a2 2 0 0 1-2 2H3m18 0h-3a2 2 0 0 1-2-2V3m0 18v-3a2 2 0 0 1 2-2h3M3 16h3a2 2 0 0 1 2 2v3"/>
							</svg>
							<span class="button-text">Windowed</span>
						</button>
					</div>
				</div>
			</div>
		</section>

		<section class="card form-section" aria-labelledby="options-heading">
			<h2 id="options-heading" class="sr-only">Playback Options</h2>
			
			<div class="options-grid">
				<div class="option-group">
					<label for="captionEnabled">Captions</label>
					<select id="captionEnabled" aria-describedby="caption-help">
						<option value="off">Off</option>
						<option value="on">On</option>
					</select>
					<div id="caption-help" class="sr-only">Enable or disable video captions</div>
				</div>

				<div class="option-group">
					<label for="captionLang">Caption Language</label>
					<select id="captionLang" aria-describedby="lang-help">
						<option value="en">English</option>
						<option value="fr">Français</option>
						<option value="es">Español</option>
						<option value="de">Deutsch</option>
						<option value="it">Italiano</option>
						<option value="pt">Português</option>
						<option value="ja">日本語</option>
						<option value="ko">한국어</option>
						<option value="zh">中文</option>
					</select>
					<div id="lang-help" class="sr-only">Select the language for video captions</div>
				</div>

				<div class="option-group">
					<label for="qualityTarget">Video Quality</label>
					<select id="qualityTarget" aria-describedby="quality-help">
						<option value="auto">Auto</option>
						<option value="144p">144p</option>
						<option value="240p">240p</option>
						<option value="360p">360p</option>
						<option value="480p">480p</option>
						<option value="720p">720p</option>
						<option value="1080p">1080p</option>
						<option value="1440p">1440p</option>
						<option value="2160p">2160p (4K)</option>
					</select>
					<div id="quality-help" class="sr-only">Select the video quality for playback</div>
				</div>

				<div class="option-group">
					<label for="qualityLock">Lock Quality</label>
					<select id="qualityLock" aria-describedby="lock-help">
						<option value="off">No</option>
						<option value="on">Yes</option>
					</select>
					<div id="lock-help" class="sr-only">Prevent automatic quality changes during playback</div>
				</div>
			</div>

			<div class="status-section">
				<div class="status-indicator">
					<div class="status-info">
						<div class="status-dot" id="statusDot" aria-hidden="true"></div>
						<span id="statusText">Checking connection...</span>
					</div>
					<button id="refreshStatus" type="button" class="refresh-button" title="Check for playing video">
						<svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
							<path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/>
							<path d="M21 3v5h-5"/>
							<path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/>
							<path d="M3 21v-5h5"/>
						</svg>
					</button>
				</div>
			</div>

			<div class="separator" role="separator"></div>

			<footer class="api-info">
				<strong>API Endpoints:</strong><br>
				<code>POST /api/play</code> - Play video<br>
				<code>POST /api/stop</code> - Stop playback<br>
				<code>POST /api/control</code> - Video controls<br>
				<code>POST /api/overlay</code> - Display mode<br>
				<code>POST /api/options</code> - Update settings<br>
				<code>GET /api/status</code> - Get current status
			</footer>
		</section>
	</main>

	<div id="toast" class="toast" role="alert" aria-live="polite"></div>

	<script src="/app.js"></script>
</body>
</html>
